---
id: AP-001
title: "Type Safety - Key Reuse Across Algorithms"
severity: HIGH
category: api-misuse
labels: [security, crypto, api-misuse]
reference: Georgiev et al. (2012)
---

# Type Safety - Key Reuse Across Algorithms

**ID:** `AP-001`
**Severity:** HIGH
**Category:** api-misuse
**Reference:** Georgiev et al. (2012)

## Description

Keys should be algorithmspecific types to prevent accidentally using AES key with ChaCha20 (and vice versa).

## Verification Method

Add phantom type parameter SecretKey<Algorithm>. Verify compile-time type checking prevents cross-use.

## Acceptance Criteria

- [ ] Test script created in `tests/security/AP-001.rs`
- [ ] Test passes locally
- [ ] Test integrated into CI pipeline
- [ ] Documentation updated
- [ ] Security review completed

## Related Issues

- Part of Extended Security Test Suite (100 tests)
- See `qa/extended-security-tests.md` for full context

## How to Verify Remediation

```bash
# Run the specific test
cargo test AP-001 --release

# Or run with verification script
./tests/security/verify_AP-001.sh

# Check for PASS output
# Exit code 0 = test passed
# Exit code 1 = test failed
```

---
**Created:** 2025-12-01
**Status:** Open
