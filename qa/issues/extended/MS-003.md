---
id: MS-003
title: "Double-Free - RNG State Cleanup"
severity: HIGH
category: memory-safety
labels: [security, crypto, memory-safety]
reference: CWE-415
---

# Double-Free - RNG State Cleanup

**ID:** `MS-003`
**Severity:** HIGH
**Category:** memory-safety
**Reference:** CWE-415

## Description

RNG state must be freed exactly once. Test with ASAN to detect double-free bugs.

## Verification Method

Run test suite with AddressSanitizer: RUSTFLAGS=-Zsanitizer=address cargo test

## Acceptance Criteria

- [ ] Test script created in `tests/security/MS-003.rs`
- [ ] Test passes locally
- [ ] Test integrated into CI pipeline
- [ ] Documentation updated
- [ ] Security review completed

## Related Issues

- Part of Extended Security Test Suite (100 tests)
- See `qa/extended-security-tests.md` for full context

## How to Verify Remediation

```bash
# Run the specific test
cargo test MS-003 --release

# Or run with verification script
./tests/security/verify_MS-003.sh

# Check for PASS output
# Exit code 0 = test passed
# Exit code 1 = test failed
```

---
**Created:** 2025-12-01
**Status:** Open
